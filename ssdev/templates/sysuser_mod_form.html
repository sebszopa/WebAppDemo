{% include 'menu.html' %}
<main>
    {% include 'context.html' %}
    <section class="content">
        <h1>System User Details</h1>
        <form name="sysusr_edit" method="post" action="/system/users/updated">
            <table>
                <tr>
                    <td><strong>Patient ID</strong></td>
                    <td><input type="text" name="p_id" value="{{ row['p_id'] }}" required></td>
                </tr>
                <tr>
                    <td><strong>Email</strong></td>
                    <td><input type="email" name="email" value="{{ row['email'] }}" required></td>
                </tr>
                <tr>
                    <td><strong>Name</strong></td>
                    <td><input type="text" name="name" value="{{ row['name'] }}" required></td>
                </tr>
                <tr>
                    <td><strong>Surname</strong></td>
                    <td><input type="text" name="surname" value="{{ row['surname'] }}" required></td>
                </tr>
                <tr>
                    <td><strong>Role</strong></td>
                    <td><input type="text" name="role" value="{{ row['role'] }}" required></td>
                </tr>
                <tr>
                    <td colspan="2">
                      <input type="hidden" name="su_id" value="{{ row['su_id'] }}">
                        <button type="submit">Save Changes</button>
                    </td>
                </tr>
            </table>
        </form>
        <br>
        <h1>Change System User Password</h1>
        <form name="update_pwd" method="post" action="/system/users/update_pwd">
            <table>
                <tr>
                    <td>Type Password</td>
                    <td><input type="password" name="pwd1" required></td>
                </tr>
                <tr>
                    <td>Retype Password</td>
                    <td><input type="password" name="pwd2" required></td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input type="hidden" name="su_id" value="{{ row['su_id'] }}">
                        <button type="submit">Change Password</button>
                    </td>
                </tr>
            </table>
        </form>
        <form name="update_pwd" method="post" action="/system/users/remove">
            <table>
                <tr>
                    <td><h1><font color="red">Remove Sytem User</font></h1></td>
                    <td>
                        <input type="hidden" name="su_id" value="{{ row['su_id'] }}">
                        <button type="submit">Delete</button>
                    </td>
                </tr>
            </table>
        </form>

        <!-- Showing data from MongoDB related to PatientID -->
        {% if row['p_id'] %}
        <br>
        <h2>Additional Details from MongoDB</h2>
        <table>
            <tr>
                <td><strong>Gender</strong></td>
                <td>{{ row['gender'] }}</td>
            </tr>
            <tr>
                <td><strong>Age</strong></td>
                <td>{{ row['age'] }}</td>
            </tr>
            <tr>
                <td><strong>Hypertension</strong></td>
                <td>{{ 'Yes' if row['has_hypertension'] else 'No' }}</td>
            </tr>
            <tr>
                <td><strong>Heart Disease</strong></td>
                <td>{{ 'Yes' if row['has_heart_disease'] else 'No' }}</td>
            </tr>
            <tr>
                <td><strong>Marital Status</strong></td>
                <td>{{ row['marital_status'] }}</td>
            </tr>
            <tr>
                <td><strong>Work Type</strong></td>
                <td>{{ row['work_type'] }}</td>
            </tr>
            <tr>
                <td><strong>Residence Type</strong></td>
                <td>{{ row['residence_type'] }}</td>
            </tr>
            <tr>
                <td><strong>Average Glucose Level</strong></td>
                <td>{{ row['avg_glucose_level'] }}</td>
            </tr>
            <tr>
                <td><strong>BMI</strong></td>
                <td>{{ row['bmi'] }}</td>
            </tr>
            <tr>
                <td><strong>Smoking Status</strong></td>
                <td>{{ row['smoking_status'] }}</td>
            </tr>
            <tr>
                <td><strong>Stroke History</strong></td>
                <td>{{ 'Yes' if row['stroke_history'] else 'No' }}</td>
            </tr>
        </table>
        {% else %}
        <p>No additional details are available for this user.</p>
        {% endif %}
    </section>
</main>
{% include 'foot.html' %}
